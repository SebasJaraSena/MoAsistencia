/**
 * Events for the grading interface.
 * @module     local_asistencia/attendance_views
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 * @copyright  2025 Zajuna team 
 **/
define(["jquery"],(function($){function tableStickyColumns(percent){const table=document.getElementById("attendance-table");if(!table)return;const isSmallScreen=window.innerWidth<=768;const headerRow=table.querySelector("thead tr");const headerCells=Array.from(headerRow.children);const rows=Array.from(table.querySelectorAll("tbody tr"));let leftOffsets=[];let accumulatedLeft=0;headerCells.forEach(((th,index)=>{if(!th.classList.contains("sticky-column")){leftOffsets.push(null);return}if(isSmallScreen&&index>0){leftOffsets.push(null);return}const width=th.getBoundingClientRect().width||150;leftOffsets.push(accumulatedLeft);accumulatedLeft+=width}));headerCells.forEach(((th,index)=>{if(!th.classList.contains("sticky-column"))return;if(leftOffsets[index]===null){th.style.position="static";th.style.left="";th.style.zIndex=""}else{th.style.position="sticky";th.style.left=`${leftOffsets[index]}px`;th.style.zIndex=2;th.style.backgroundColor="#f1f1f1";th.style.fontSize="14px"}}));rows.forEach((row=>{const cells=Array.from(row.children);cells.forEach(((td,index)=>{if(!td.classList.contains("sticky-column"))return;const text=td.innerText.trim();if(leftOffsets[index]===null){td.style.position="static";td.style.left="";td.style.zIndex=""}else{td.style.position="sticky";td.style.left=`${leftOffsets[index]}px`;td.style.zIndex=1}if(text==="SUSPENDIDO"){td.style.backgroundColor="#fcefdc"}else if(text==="ACTIVO"){td.style.backgroundColor="#def1de"}else{td.style.backgroundColor="#f1f1f1"}}))}));const visibleHeaderCells=headerCells.filter((cell=>cell.offsetParent!==null));if(visibleHeaderCells.length<=7){table.style.minWidth="100%";table.style.width="100%"}else{table.style.minWidth="auto";table.style.width="auto"}}function waitForElement(selector,callback){const interval=setInterval((()=>{if(document.querySelector(selector)){clearInterval(interval);callback()}}),100)}function enableSearchWithStickyUpdate(percent){const searchInput=document.getElementById("searchInput");if(!searchInput)return;searchInput.addEventListener("keyup",(function(){const filter=normalizeText(searchInput.value);const table=document.getElementById("attendance-table");if(!table)return;const rows=table.querySelectorAll("tbody tr");rows.forEach((row=>{const text=normalizeText(row.innerText);row.style.display=text.includes(filter)?"":"none"}));tableStickyColumns(percent)}));function normalizeText(text){return text.trim().normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()}}return{init:function(){waitForElement("#attendance-table",(function(){const percent=window.innerWidth>768?1:.2;tableStickyColumns(percent);enableSearchWithStickyUpdate(percent);window.addEventListener("resize",(function(){const mainbox=document.getElementById("region-main-box");if(mainbox){mainbox.style.setProperty("flex","0 0 100%","important");mainbox.style.setProperty("max-width","100%","important")}const newPercent=window.innerWidth>768?1:.2;tableStickyColumns(newPercent)}))}))},refreshSticky:tableStickyColumns}}));
//# sourceMappingURL=attendance_views.min.js.map